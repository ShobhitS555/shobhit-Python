this is called in run function 